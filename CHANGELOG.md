# 更新日志 | Changelog

## v1.3.0 (2025-10-13)

### ✨ 新增功能

#### 📊 累计支出统计
- **替换**："总价值" → "累计支出"
- **计算逻辑**：续费价格 × 域名年龄 × 汇率
- **支持场景**：
  - 有注册时间：计算实际使用年数
  - 已过期域名：计算到过期时的总支出
  - 无注册时间：按1年计算
- **多币种**：自动转换为人民币显示

#### 🏷️ 续费价格标注
- **卡片显示**：价格下方标注"续费价格"
- **表单标签**：明确显示"续费价格"字段
- **多语言**：中英文对应翻译

#### 📚 文档结构优化
- **根目录**：只保留 README.md（简洁版）
- **docs 文件夹**：详细文档集中管理
- **仓库地址**：更新为正确的 GitHub 地址

#### 📱 PWA 支持
- **可安装**：添加到桌面/主屏幕
- **离线缓存**：Service Worker 支持
- **原生体验**：独立窗口运行

#### 🤖 爬虫防护
- **robots.txt**：禁止所有搜索引擎
- **meta 标签**：noindex, nofollow
- **隐私保护**：防止敏感信息被索引

### 🛠 技术改进

#### 💾 Vercel KV 集成
- **智能切换**：本地文件存储 ↔ 云端 KV 存储
- **数据持久化**：云端存储，重部署不丢失
- **自动检测**：环境自适应

#### 🌍 多语言优化
- **浏览器检测**：自动识别用户语言偏好
- **路由优化**：修复重定向循环问题
- **构建修复**：解决 next-intl 静态渲染问题

#### 📱 移动端优化
- **响应式间距**：移动端紧凑布局
- **触摸优化**：适配触摸设备交互
- **防缩放**：禁用用户缩放，保持布局

### 🎨 界面优化

#### 📊 统计面板
- **位置**：页面顶部
- **布局**：桌面4列，移动端2列
- **动画**：错开滑入效果

#### 🃏 域名卡片
- **结构重新设计**：3段式布局
- **注册商角标**：右上角显示
- **时间信息**：2列网格布局
- **操作按钮**：续费+设置菜单

#### 🔍 搜索筛选
- **单行布局**：搜索、筛选、排序、添加在一行
- **样式统一**：圆角设计，悬停效果
- **清除按钮**：搜索框支持快速清除

### 🔧 开发工具

#### 📝 日期输入增强
- **智能识别**：支持多种日期格式
  - 20250808（8位数字）
  - 2025-08-08（ISO格式）  
  - 08/08/2025（美式）
  - 2025年8月8日（中文）
- **粘贴支持**：自动解析粘贴的日期文本
- **多语言**：根据语言显示不同提示

#### 🔄 WHOIS 查询
- **集成**：使用站长之家 WHOIS 查询
- **位置**：添加域名表单中的辅助按钮
- **快速访问**：卡片上也支持 WHOIS 查询

### 📦 项目优化

#### 📁 文件结构
```
精简前：45+ 文件（包含10个文档）
精简后：35+ 文件（6个核心文档）

根目录：README.md（简洁门面）
docs/：详细文档（5个精品文档）
```

#### 🗂 文档精简
- **删除**：6个重复/过时文档
- **合并**：相关内容整合
- **重组**：按用途分类

---

## 📊 累计支出计算说明

### 计算公式

```
累计支出 = 续费价格 × 使用年数 × 汇率

使用年数 = 
├── 有注册时间 && 未过期 → (当前时间 - 注册时间) / 365.25天
├── 有注册时间 && 已过期 → (过期时间 - 注册时间) / 365.25天  
└── 无注册时间 → 1年（默认）

汇率（转为人民币）:
├── CNY → 1.0
├── USD → 7.3
├── EUR → 7.8
├── GBP → 9.1
├── JPY → 0.05
└── HKD → 0.93
```

### 计算示例

**例1：正常域名**
```
域名：example.com
注册时间：2020-01-01
到期时间：2025-12-31（未过期）
续费价格：$12/年

计算：
使用年数 = (2025-10-13 - 2020-01-01) / 365.25 ≈ 5.8年
累计支出 = $12 × 5.8年 × 7.3汇率 ≈ ¥508
```

**例2：已过期域名**
```
域名：old.com  
注册时间：2018-06-01
到期时间：2023-06-01（已过期）
续费价格：¥80/年

计算：
使用年数 = (2023-06-01 - 2018-06-01) / 365.25 = 5年
累计支出 = ¥80 × 5年 × 1.0汇率 = ¥400
```

**例3：无注册时间**
```
域名：test.com
注册时间：未知
续费价格：€15/年

计算：
使用年数 = 1年（默认）
累计支出 = €15 × 1年 × 7.8汇率 ≈ ¥117
```

---

**优化完成！** 统计更加准确，价格标注更加清晰！ 🚀
